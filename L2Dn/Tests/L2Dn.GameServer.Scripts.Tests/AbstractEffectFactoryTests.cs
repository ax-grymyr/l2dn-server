using System.Reflection;
using FluentAssertions;
using L2Dn.GameServer.Handlers;
using L2Dn.GameServer.Scripts.Handlers.EffectHandlers;

namespace L2Dn.GameServer.Scripts.Tests;

public class AbstractEffectFactoryTests
{
    [Fact]
    public void TestAttributes()
    {
        Dictionary<string, Type> oldList = GetOldList();
        Dictionary<string, Type> newList = GetNewList();
        List<string> missingKeys = oldList.Keys.Where(k => !newList.ContainsKey(k)).ToList();
        if (missingKeys.Count != 0)
            Assert.Fail($"Missing keys: {string.Join(", ", missingKeys)}");

        oldList.Count.Should().BeLessOrEqualTo(newList.Count);
        foreach (KeyValuePair<string, Type> pair in oldList)
        {
            newList.ContainsKey(pair.Key).Should().BeTrue();
            newList[pair.Key].Should().Be(pair.Value);
        }
    }

    private static Dictionary<string, Type> GetNewList()
    {
        Dictionary<string, Type> dict = typeof(Scripts).Assembly.GetTypes().
            Select(t => (t, t.GetCustomAttribute<AbstractEffectNameAttribute>()?.Name ?? string.Empty)).
            Where(t => !string.IsNullOrEmpty(t.Item2)).ToDictionary(t => t.Item2, t => t.Item1);

        return dict;
    }

    private static Dictionary<string, Type> GetOldList()
    {
        Dictionary<string, Type> old = new(StringComparer.OrdinalIgnoreCase);
        old.Add("AbnormalShield", typeof(AbnormalShield));
        old.Add("AbnormalTimeChange", typeof(AbnormalTimeChange));
        old.Add("AbnormalTimeChangeBySkillId", typeof(AbnormalTimeChangeBySkillId));
        old.Add("AbsorbDamage", typeof(AbsorbDamage));
        old.Add("Accuracy", typeof(Accuracy));
        old.Add("AddHate", typeof(AddHate));
        old.Add("AddHuntingTime", typeof(AddHuntingTime));
        old.Add("AdditionalPhysicalAttack", typeof(AdditionalPhysicalAttack));
        old.Add("AdditionalPotionCp", typeof(AdditionalPotionCp));
        old.Add("AdditionalPotionHp", typeof(AdditionalPotionHp));
        old.Add("AdditionalPotionMp", typeof(AdditionalPotionMp));
        old.Add("AddPcCafePoints", typeof(AddPcCafePoints));
        old.Add("AddMaxPhysicalCriticalRate", typeof(AddMaxPhysicalCriticalRate));
        old.Add("AddMaxMagicCriticalRate", typeof(AddMaxMagicCriticalRate));
        old.Add("AddSkillBySkill", typeof(AddSkillBySkill));
        old.Add("AddTeleportBookmarkSlot", typeof(AddTeleportBookmarkSlot));
        old.Add("AgathionSlot", typeof(AgathionSlot));
        old.Add("AreaDamage", typeof(AreaDamage));
        old.Add("AreaOfEffectDamageDefence", typeof(AreaOfEffectDamageDefence));
        old.Add("AreaOfEffectDamageModify", typeof(AreaOfEffectDamageModify));
        old.Add("ArtifactSlot", typeof(ArtifactSlot));
        old.Add("AttackAttribute", typeof(AttackAttribute));
        old.Add("AttackAttributeAdd", typeof(AttackAttributeAdd));
        old.Add("AttackBehind", typeof(AttackBehind));
        old.Add("AttackTrait", typeof(AttackTrait));
        old.Add("AutoAttackDamageBonus", typeof(AutoAttackDamageBonus));
        old.Add("Backstab", typeof(Backstab));
        old.Add("Betray", typeof(Betray));
        old.Add("Blink", typeof(Blink));
        old.Add("BlinkSwap", typeof(BlinkSwap));
        old.Add("BlockAbnormalSlot", typeof(BlockAbnormalSlot));
        old.Add("BlockAction", typeof(BlockAction));
        old.Add("BlockActions", typeof(BlockActions));
        old.Add("BlockChat", typeof(BlockChat));
        old.Add("BlockControl", typeof(BlockControl));
        old.Add("BlockEscape", typeof(BlockEscape));
        old.Add("BlockMove", typeof(BlockMove));
        old.Add("BlockParty", typeof(BlockParty));
        old.Add("BlockResurrection", typeof(BlockResurrection));
        old.Add("BlockSkill", typeof(BlockSkill));
        old.Add("BlockTarget", typeof(BlockTarget));
        old.Add("Bluff", typeof(Bluff));
        old.Add("BonusDropAdena", typeof(BonusDropAdena));
        old.Add("BonusDropAmount", typeof(BonusDropAmount));
        old.Add("BonusDropRate", typeof(BonusDropRate));
        old.Add("BonusDropRateLCoin", typeof(BonusDropRateLCoin));
        old.Add("BonusRaidPoints", typeof(BonusRaidPoints));
        old.Add("BonusSpoilRate", typeof(BonusSpoilRate));
        old.Add("Breath", typeof(Breath));
        old.Add("BuffBlock", typeof(BuffBlock));
        old.Add("CallLearnedSkill", typeof(CallLearnedSkill));
        old.Add("CallParty", typeof(CallParty));
        old.Add("CallPc", typeof(CallPc));
        old.Add("CallRandomSkill", typeof(CallRandomSkill));
        old.Add("CallSkill", typeof(CallSkill));
        old.Add("CallSkillOnActionTime", typeof(CallSkillOnActionTime));
        old.Add("CallTargetParty", typeof(CallTargetParty));
        old.Add("CheapShot", typeof(CheapShot));
        old.Add("ChameleonRest", typeof(ChameleonRest));
        old.Add("ChangeBody", typeof(ChangeBody));
        old.Add("ChangeFace", typeof(ChangeFace));
        old.Add("ChangeFishingMastery", typeof(ChangeFishingMastery));
        old.Add("ChangeHairColor", typeof(ChangeHairColor));
        old.Add("ChangeHairStyle", typeof(ChangeHairStyle));
        old.Add("ClassChange", typeof(ClassChange));
        old.Add("Compelling", typeof(Compelling));
        old.Add("Confuse", typeof(Confuse));
        old.Add("ConsumeBody", typeof(ConsumeBody));
        old.Add("ConvertItem", typeof(ConvertItem));
        old.Add("CounterPhysicalSkill", typeof(CounterPhysicalSkill));
        old.Add("Cp", typeof(Cp));
        old.Add("CpHeal", typeof(CpHeal));
        old.Add("CpHealOverTime", typeof(CpHealOverTime));
        old.Add("CpHealPercent", typeof(CpHealPercent));
        old.Add("CpRegen", typeof(CpRegen));
        old.Add("CraftingCritical", typeof(CraftingCritical));
        old.Add("CraftRate", typeof(CraftRate));
        old.Add("CriticalDamage", typeof(CriticalDamage));
        old.Add("CriticalDamagePosition", typeof(CriticalDamagePosition));
        old.Add("CriticalRate", typeof(CriticalRate));
        old.Add("CriticalRatePositionBonus", typeof(CriticalRatePositionBonus));
        old.Add("CubicMastery", typeof(CubicMastery));
        old.Add("DamageBlock", typeof(DamageBlock));
        old.Add("DamageByAttack", typeof(DamageByAttack));
        old.Add("DamageShield", typeof(DamageShield));
        old.Add("DamageShieldResist", typeof(DamageShieldResist));
        old.Add("DamOverTime", typeof(DamOverTime));
        old.Add("DamOverTimePercent", typeof(DamOverTimePercent));
        old.Add("DeathLink", typeof(DeathLink));
        old.Add("DebuffBlock", typeof(DebuffBlock));
        old.Add("DefenceAttribute", typeof(DefenceAttribute));
        old.Add("DefenceCriticalDamage", typeof(DefenceCriticalDamage));
        old.Add("DefenceCriticalRate", typeof(DefenceCriticalRate));
        old.Add("DefenceIgnoreRemoval", typeof(DefenceIgnoreRemoval));
        old.Add("DefenceMagicCriticalDamage", typeof(DefenceMagicCriticalDamage));
        old.Add("DefenceMagicCriticalRate", typeof(DefenceMagicCriticalRate));
        old.Add("DefencePhysicalSkillCriticalDamage", typeof(DefencePhysicalSkillCriticalDamage));
        old.Add("DefencePhysicalSkillCriticalRate", typeof(DefencePhysicalSkillCriticalRate));
        old.Add("DefenceTrait", typeof(DefenceTrait));
        old.Add("DeleteHate", typeof(DeleteHate));
        old.Add("DeleteHateOfMe", typeof(DeleteHateOfMe));
        old.Add("DeleteTopAgro", typeof(DeleteTopAgro));
        old.Add("DetectHiddenObjects", typeof(DetectHiddenObjects));
        old.Add("Detection", typeof(Detection));
        old.Add("DisableSkill", typeof(DisableSkill));
        old.Add("DisableTargeting", typeof(DisableTargeting));
        old.Add("Disarm", typeof(Disarm));
        old.Add("Disarmor", typeof(Disarmor));
        old.Add("DispelAll", typeof(DispelAll));
        old.Add("DispelByCategory", typeof(DispelByCategory));
        old.Add("DispelBySlot", typeof(DispelBySlot));
        old.Add("DispelBySlotMyself", typeof(DispelBySlotMyself));
        old.Add("DispelBySlotProbability", typeof(DispelBySlotProbability));
        old.Add("DoubleCast", typeof(DoubleCast));
        old.Add("DuelistFury", typeof(DuelistFury));
        old.Add("ElementalSpiritAttack", typeof(ElementalSpiritAttack));
        old.Add("ElementalSpiritDefense", typeof(ElementalSpiritDefense));
        old.Add("ElixirUsageLimit", typeof(ElixirUsageLimit));
        old.Add("EnableCloak", typeof(EnableCloak));
        old.Add("EnchantRate", typeof(EnchantRate));
        old.Add("EnergyAttack", typeof(EnergyAttack));
        old.Add("EnlargeAbnormalSlot", typeof(EnlargeAbnormalSlot));
        old.Add("EnlargeSlot", typeof(EnlargeSlot));
        old.Add("Escape", typeof(Escape));
        old.Add("ExpModify", typeof(ExpModify));
        old.Add("ExpModifyPet", typeof(ExpModifyPet));
        old.Add("Faceoff", typeof(Faceoff));
        old.Add("FakeDeath", typeof(FakeDeath));
        old.Add("FatalBlow", typeof(FatalBlow));
        old.Add("FatalBlowRate", typeof(FatalBlowRate));
        old.Add("FatalBlowRateDefence", typeof(FatalBlowRateDefence));
        old.Add("Fear", typeof(Fear));
        old.Add("Feed", typeof(Feed));
        old.Add("FeedModify", typeof(FeedModify));
        old.Add("FishingExpSpBonus", typeof(FishingExpSpBonus));
        old.Add("Flag", typeof(Flag));
        old.Add("FocusEnergy", typeof(FocusEnergy));
        old.Add("FocusMomentum", typeof(FocusMomentum));
        old.Add("FocusMaxMomentum", typeof(FocusMaxMomentum));
        old.Add("FocusSouls", typeof(FocusSouls));
        old.Add("GetAgro", typeof(GetAgro));
        old.Add("GetDamageLimit", typeof(GetDamageLimit));
        old.Add("GetMomentum", typeof(GetMomentum));
        old.Add("GiveClanReputation", typeof(GiveClanReputation));
        old.Add("GiveExpAndSp", typeof(GiveExpAndSp));
        old.Add("GiveFame", typeof(GiveFame));
        old.Add("GiveHonorCoins", typeof(GiveHonorCoins));
        old.Add("GiveItemByExp", typeof(GiveItemByExp));
        old.Add("GivePetXp", typeof(GivePetXp));
        old.Add("GiveRecommendation", typeof(GiveRecommendation));
        old.Add("GiveSp", typeof(GiveSp));
        old.Add("GiveXp", typeof(GiveXp));
        old.Add("Grow", typeof(Grow));
        old.Add("HairAccessorySet", typeof(HairAccessorySet));
        old.Add("Harvesting", typeof(Harvesting));
        old.Add("HateAttack", typeof(HateAttack));
        old.Add("HeadquarterCreate", typeof(HeadquarterCreate));
        old.Add("Heal", typeof(Heal));
        old.Add("HealEffect", typeof(HealEffect));
        old.Add("HealOverTime", typeof(HealOverTime));
        old.Add("HealPercent", typeof(HealPercent));
        old.Add("Hide", typeof(Hide));
        old.Add("HitNumber", typeof(HitNumber));
        old.Add("Hp", typeof(Hp));
        old.Add("HpByLevel", typeof(HpByLevel));
        old.Add("HpCpHeal", typeof(HpCpHeal));
        old.Add("HpCpHealCritical", typeof(HpCpHealCritical));
        old.Add("HpDrain", typeof(HpDrain));
        old.Add("HpLimit", typeof(HpLimit));
        old.Add("HpRegen", typeof(HpRegen));
        old.Add("HpToOwner", typeof(HpToOwner));
        old.Add("IgnoreDeath", typeof(IgnoreDeath));
        old.Add("IgnoreReduceDamage", typeof(IgnoreReduceDamage));
        old.Add("ImmobileDamageBonus", typeof(ImmobileDamageBonus));
        old.Add("ImmobileDamageResist", typeof(ImmobileDamageResist));
        old.Add("ImmobilePetBuff", typeof(ImmobilePetBuff));
        old.Add("InstantKillResist", typeof(InstantKillResist));
        old.Add("JewelSlot", typeof(JewelSlot));
        old.Add("KarmaCount", typeof(KarmaCount));
        old.Add("KnockBack", typeof(KnockBack));
        old.Add("Lethal", typeof(Lethal));
        old.Add("LimitCp", typeof(LimitCp));
        old.Add("LimitHp", typeof(LimitHp));
        old.Add("LimitMp", typeof(LimitMp));
        old.Add("Lucky", typeof(Lucky));
        old.Add("MagicAccuracy", typeof(MagicAccuracy));
        old.Add("MagicalAbnormalDispelAttack", typeof(MagicalAbnormalDispelAttack));
        old.Add("MagicalAbnormalResist", typeof(MagicalAbnormalResist));
        old.Add("MagicalAttack", typeof(MagicalAttack));
        old.Add("MagicalAttackByAbnormal", typeof(MagicalAttackByAbnormal));
        old.Add("MagicalAttackByAbnormalSlot", typeof(MagicalAttackByAbnormalSlot));
        old.Add("MagicalAttackMp", typeof(MagicalAttackMp));
        old.Add("MagicalAttackRange", typeof(MagicalAttackRange));
        old.Add("MagicalAttackSpeed", typeof(MagicalAttackSpeed));
        old.Add("MagicalDamOverTime", typeof(MagicalDamOverTime));
        old.Add("MagicalDefence", typeof(MagicalDefence));
        old.Add("MagicalEvasion", typeof(MagicalEvasion));
        old.Add("MagicalSkillPower", typeof(MagicalSkillPower));
        old.Add("MagicalSoulAttack", typeof(MagicalSoulAttack));
        old.Add("MagicCriticalDamage", typeof(MagicCriticalDamage));
        old.Add("MagicCriticalRate", typeof(MagicCriticalRate));
        old.Add("MagicCriticalRateByCriticalRate", typeof(MagicCriticalRateByCriticalRate));
        old.Add("MagicLampExpRate", typeof(MagicLampExpRate));
        old.Add("MagicMpCost", typeof(MagicMpCost));
        old.Add("ManaCharge", typeof(ManaCharge));
        old.Add("ManaDamOverTime", typeof(ManaDamOverTime));
        old.Add("ManaHeal", typeof(ManaHeal));
        old.Add("ManaHealByLevel", typeof(ManaHealByLevel));
        old.Add("ManaHealOverTime", typeof(ManaHealOverTime));
        old.Add("ManaHealPercent", typeof(ManaHealPercent));
        old.Add("MAtk", typeof(MAtk));
        old.Add("MAtkByPAtk", typeof(MAtkByPAtk));
        old.Add("MaxCp", typeof(MaxCp));
        old.Add("MaxHp", typeof(MaxHp));
        old.Add("MaxMp", typeof(MaxMp));
        old.Add("ModifyAssassinationPoints", typeof(ModifyAssassinationPoints));
        old.Add("ModifyBeastPoints", typeof(ModifyBeastPoints));
        old.Add("ModifyCraftPoints", typeof(ModifyCraftPoints));
        old.Add("ModifyDeathPoints", typeof(ModifyDeathPoints));
        old.Add("ModifyMagicLampPoints", typeof(ModifyMagicLampPoints));
        old.Add("ModifyVital", typeof(ModifyVital));
        old.Add("Mp", typeof(Mp));
        old.Add("MpConsumePerLevel", typeof(MpConsumePerLevel));
        old.Add("MpRegen", typeof(MpRegen));
        old.Add("MpShield", typeof(MpShield));
        old.Add("MpVampiricAttack", typeof(MpVampiricAttack));
        old.Add("Mute", typeof(Mute));
        old.Add("NewHennaSlot", typeof(NewHennaSlot));
        old.Add("NightStatModify", typeof(NightStatModify));
        old.Add("NoblesseBless", typeof(NoblesseBless));
        old.Add("OpenChest", typeof(OpenChest));
        old.Add("OpenCommonRecipeBook", typeof(OpenCommonRecipeBook));
        old.Add("OpenDoor", typeof(OpenDoor));
        old.Add("OpenDwarfRecipeBook", typeof(OpenDwarfRecipeBook));
        old.Add("Passive", typeof(Passive));
        old.Add("PAtk", typeof(PAtk));
        old.Add("PhysicalAbnormalResist", typeof(PhysicalAbnormalResist));
        old.Add("PhysicalAttack", typeof(PhysicalAttack));
        old.Add("PhysicalAttackHpLink", typeof(PhysicalAttackHpLink));
        old.Add("PhysicalAttackMute", typeof(PhysicalAttackMute));
        old.Add("PhysicalAttackRange", typeof(PhysicalAttackRange));
        old.Add("PhysicalAttackSaveHp", typeof(PhysicalAttackSaveHp));
        old.Add("PhysicalAttackSpeed", typeof(PhysicalAttackSpeed));
        old.Add("PhysicalAttackWeaponBonus", typeof(PhysicalAttackWeaponBonus));
        old.Add("PhysicalDefence", typeof(PhysicalDefence));
        old.Add("PhysicalEvasion", typeof(PhysicalEvasion));
        old.Add("PhysicalMute", typeof(PhysicalMute));
        old.Add("PhysicalShieldAngleAll", typeof(PhysicalShieldAngleAll));
        old.Add("PhysicalSkillCriticalDamage", typeof(PhysicalSkillCriticalDamage));
        old.Add("PhysicalSkillCriticalRate", typeof(PhysicalSkillCriticalRate));
        old.Add("PhysicalSkillPower", typeof(PhysicalSkillPower));
        old.Add("PhysicalSoulAttack", typeof(PhysicalSoulAttack));
        old.Add("PkCount", typeof(PkCount));
        old.Add("Plunder", typeof(Plunder));
        old.Add("PolearmSingleTarget", typeof(PolearmSingleTarget));
        old.Add("ProtectionBlessing", typeof(ProtectionBlessing));
        old.Add("ProtectDeathPenalty", typeof(ProtectDeathPenalty));
        old.Add("PullBack", typeof(PullBack));
        old.Add("PveMagicalSkillDamageBonus", typeof(PveMagicalSkillDamageBonus));
        old.Add("PveMagicalSkillDefenceBonus", typeof(PveMagicalSkillDefenceBonus));
        old.Add("PvePhysicalAttackDamageBonus", typeof(PvePhysicalAttackDamageBonus));
        old.Add("PvePhysicalAttackDefenceBonus", typeof(PvePhysicalAttackDefenceBonus));
        old.Add("PvePhysicalSkillDamageBonus", typeof(PvePhysicalSkillDamageBonus));
        old.Add("PvePhysicalSkillDefenceBonus", typeof(PvePhysicalSkillDefenceBonus));
        old.Add("PveRaidMagicalSkillDamageBonus", typeof(PveRaidMagicalSkillDamageBonus));
        old.Add("PveRaidMagicalSkillDefenceBonus", typeof(PveRaidMagicalSkillDefenceBonus));
        old.Add("PveRaidPhysicalAttackDamageBonus", typeof(PveRaidPhysicalAttackDamageBonus));
        old.Add("PveRaidPhysicalAttackDefenceBonus", typeof(PveRaidPhysicalAttackDefenceBonus));
        old.Add("PveRaidPhysicalSkillDamageBonus", typeof(PveRaidPhysicalSkillDamageBonus));
        old.Add("PveRaidPhysicalSkillDefenceBonus", typeof(PveRaidPhysicalSkillDefenceBonus));
        old.Add("PvpMagicalSkillDamageBonus", typeof(PvpMagicalSkillDamageBonus));
        old.Add("PvpMagicalSkillDefenceBonus", typeof(PvpMagicalSkillDefenceBonus));
        old.Add("PvpPhysicalAttackDamageBonus", typeof(PvpPhysicalAttackDamageBonus));
        old.Add("PvpPhysicalAttackDefenceBonus", typeof(PvpPhysicalAttackDefenceBonus));
        old.Add("PvpPhysicalSkillDamageBonus", typeof(PvpPhysicalSkillDamageBonus));
        old.Add("PvpPhysicalSkillDefenceBonus", typeof(PvpPhysicalSkillDefenceBonus));
        old.Add("RandomizeHate", typeof(RandomizeHate));
        old.Add("RealDamage", typeof(RealDamage));
        old.Add("RealDamageResist", typeof(RealDamageResist));
        old.Add("RearDamage", typeof(RearDamage));
        old.Add("RebalanceHP", typeof(RebalanceHP));
        old.Add("RebalanceHPSummon", typeof(RebalanceHPSummon));
        old.Add("RecoverVitalityInPeaceZone", typeof(RecoverVitalityInPeaceZone));
        old.Add("ReduceDamage", typeof(ReduceDamage));
        old.Add("ReduceCancel", typeof(ReduceCancel));
        old.Add("ReduceDropPenalty", typeof(ReduceDropPenalty));
        old.Add("ReflectMagic", typeof(ReflectMagic));
        old.Add("ReflectSkill", typeof(ReflectSkill));
        old.Add("RefuelAirship", typeof(RefuelAirship));
        old.Add("Relax", typeof(Relax));
        old.Add("ReplaceSkillBySkill", typeof(ReplaceSkillBySkill));
        old.Add("ResetInstanceEntry", typeof(ResetInstanceEntry));
        old.Add("ResistAbnormalByCategory", typeof(ResistAbnormalByCategory));
        old.Add("ResistDDMagic", typeof(ResistDDMagic));
        old.Add("ResistDispelByCategory", typeof(ResistDispelByCategory));
        old.Add("ResistSkill", typeof(ResistSkill));
        old.Add("Restoration", typeof(Restoration));
        old.Add("RestorationRandom", typeof(RestorationRandom));
        old.Add("Resurrection", typeof(Resurrection));
        old.Add("ResurrectionFeeModifier", typeof(ResurrectionFeeModifier));
        old.Add("ResurrectionSpecial", typeof(ResurrectionSpecial));
        old.Add("Reuse", typeof(Reuse));
        old.Add("ReuseSkillById", typeof(ReuseSkillById));
        old.Add("ReuseSkillIdByDamage", typeof(ReuseSkillIdByDamage));
        old.Add("Root", typeof(Root));
        old.Add("SacrificeSummon", typeof(SacrificeSummon));
        old.Add("SafeFallHeight", typeof(SafeFallHeight));
        old.Add("SayhaGraceSupport", typeof(SayhaGraceSupport));
        old.Add("SendSystemMessageToClan", typeof(SendSystemMessageToClan));
        old.Add("ServitorShare", typeof(ServitorShare));
        old.Add("ServitorShareSkills", typeof(ServitorShareSkills));
        old.Add("SetHp", typeof(SetHp));
        old.Add("SetCp", typeof(SetCp));
        old.Add("SetSkill", typeof(SetSkill));
        old.Add("ShieldDefence", typeof(ShieldDefence));
        old.Add("ShieldDefenceIgnoreRemoval", typeof(ShieldDefenceIgnoreRemoval));
        old.Add("ShieldDefenceRate", typeof(ShieldDefenceRate));
        old.Add("ShotsBonus", typeof(ShotsBonus));
        old.Add("SilentMove", typeof(SilentMove));
        old.Add("SkillBonusRange", typeof(SkillBonusRange));
        old.Add("SkillEvasion", typeof(SkillEvasion));
        old.Add("SkillMastery", typeof(SkillMastery));
        old.Add("SkillMasteryRate", typeof(SkillMasteryRate));
        old.Add("SkillPowerAdd", typeof(SkillPowerAdd));
        old.Add("SkillTurning", typeof(SkillTurning));
        old.Add("SkillTurningOverTime", typeof(SkillTurningOverTime));
        old.Add("SoulBlow", typeof(SoulBlow));
        old.Add("SoulEating", typeof(SoulEating));
        old.Add("SoulshotResistance", typeof(SoulshotResistance));
        old.Add("Sow", typeof(Sow));
        old.Add("Speed", typeof(Speed));
        old.Add("SphericBarrier", typeof(SphericBarrier));
        old.Add("SpeedLimit", typeof(SpeedLimit));
        old.Add("SpiritExpModify", typeof(SpiritExpModify));
        old.Add("SpiritshotResistance", typeof(SpiritshotResistance));
        old.Add("SpModify", typeof(SpModify));
        old.Add("Spoil", typeof(Spoil));
        old.Add("StatAddForLevel", typeof(StatAddForLevel));
        old.Add("StatAddForMp", typeof(StatAddForMp));
        old.Add("StatAddForStat", typeof(StatAddForStat));
        old.Add("StatBonusSkillCritical", typeof(StatBonusSkillCritical));
        old.Add("StatBonusSpeed", typeof(StatBonusSpeed));
        old.Add("StatByMoveType", typeof(StatByMoveType));
        old.Add("StatMulForBaseStat", typeof(StatMulForBaseStat));
        old.Add("StatMulForLevel", typeof(StatMulForLevel));
        old.Add("StatUp", typeof(StatUp));
        old.Add("StealAbnormal", typeof(StealAbnormal));
        old.Add("Summon", typeof(Summon));
        old.Add("SummonAgathion", typeof(SummonAgathion));
        old.Add("SummonCubic", typeof(SummonCubic));
        old.Add("SummonHallucination", typeof(SummonHallucination));
        old.Add("SummonMulti", typeof(SummonMulti));
        old.Add("SummonNpc", typeof(SummonNpc));
        old.Add("SummonPet", typeof(SummonPet));
        old.Add("SummonPoints", typeof(SummonPoints));
        old.Add("SummonTrap", typeof(SummonTrap));
        old.Add("Sweeper", typeof(Sweeper));
        old.Add("Synergy", typeof(Synergy));
        old.Add("TakeCastle", typeof(TakeCastle));
        old.Add("TakeCastleStart", typeof(TakeCastleStart));
        old.Add("TakeFort", typeof(TakeFort));
        old.Add("TakeFortStart", typeof(TakeFortStart));
        old.Add("TalismanSlot", typeof(TalismanSlot));
        old.Add("TargetCancel", typeof(TargetCancel));
        old.Add("TargetMe", typeof(TargetMe));
        old.Add("TargetMeProbability", typeof(TargetMeProbability));
        old.Add("Teleport", typeof(Teleport));
        old.Add("TeleportToNpc", typeof(TeleportToNpc));
        old.Add("TeleportToPlayer", typeof(TeleportToPlayer));
        old.Add("TeleportToSummon", typeof(TeleportToSummon));
        old.Add("TeleportToTarget", typeof(TeleportToTarget));
        old.Add("TeleportToTeleportLocation", typeof(TeleportToTeleportLocation));
        old.Add("FlyAway", typeof(FlyAway));
        old.Add("TransferDamageToPlayer", typeof(TransferDamageToPlayer));
        old.Add("TransferDamageToSummon", typeof(TransferDamageToSummon));
        old.Add("TransferHate", typeof(TransferHate));
        old.Add("Transformation", typeof(Transformation));
        old.Add("TrapDetect", typeof(TrapDetect));
        old.Add("TrapRemove", typeof(TrapRemove));
        old.Add("TriggerHealPercentBySkill", typeof(TriggerHealPercentBySkill));
        old.Add("TriggerSkill", typeof(TriggerSkill));
        old.Add("TriggerSkillByAttack", typeof(TriggerSkillByAttack));
        old.Add("TriggerSkillByAvoid", typeof(TriggerSkillByAvoid));
        old.Add("TriggerSkillByBaseStat", typeof(TriggerSkillByBaseStat));
        old.Add("TriggerSkillByDamage", typeof(TriggerSkillByDamage));
        old.Add("TriggerSkillByDeathBlow", typeof(TriggerSkillByDeathBlow));
        old.Add("TriggerSkillByDualRange", typeof(TriggerSkillByDualRange));
        old.Add("TriggerSkillByHpPercent", typeof(TriggerSkillByHpPercent));
        old.Add("TriggerSkillByKill", typeof(TriggerSkillByKill));
        old.Add("TriggerSkillByMagicType", typeof(TriggerSkillByMagicType));
        old.Add("TriggerSkillByMaxHp", typeof(TriggerSkillByMaxHp));
        old.Add("TriggerSkillBySkill", typeof(TriggerSkillBySkill));
        old.Add("TriggerSkillBySkillAttack", typeof(TriggerSkillBySkillAttack));
        old.Add("TriggerSkillByStat", typeof(TriggerSkillByStat));
        old.Add("TwoHandedBluntBonus", typeof(TwoHandedBluntBonus));
        old.Add("TwoHandedStance", typeof(TwoHandedStance));
        old.Add("TwoHandedSwordBonus", typeof(TwoHandedSwordBonus));
        old.Add("Unsummon", typeof(Unsummon));
        old.Add("UnsummonAgathion", typeof(UnsummonAgathion));
        old.Add("UnsummonServitors", typeof(UnsummonServitors));
        old.Add("Untargetable", typeof(Untargetable));
        old.Add("VampiricAttack", typeof(VampiricAttack));
        old.Add("VampiricDefence", typeof(VampiricDefence));
        old.Add("VipUp", typeof(VipUp));
        old.Add("VitalityExpRate", typeof(VitalityExpRate));
        old.Add("VitalityPointsRate", typeof(VitalityPointsRate));
        old.Add("VitalityPointUp", typeof(VitalityPointUp));
        old.Add("WeaponAttackAngleBonus", typeof(WeaponAttackAngleBonus));
        old.Add("WeaponBonusMAtk", typeof(WeaponBonusMAtk));
        old.Add("WeaponBonusMAtkMultiplier", typeof(WeaponBonusMAtkMultiplier));
        old.Add("WeaponBonusPAtk", typeof(WeaponBonusPAtk));
        old.Add("WeaponBonusPAtkMultiplier", typeof(WeaponBonusPAtkMultiplier));
        old.Add("WeightLimit", typeof(WeightLimit));
        old.Add("WeightPenalty", typeof(WeightPenalty));
        old.Add("WorldChatPoints", typeof(WorldChatPoints));
        return old;
    }
}